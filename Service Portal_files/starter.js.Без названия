!function(){"use strict";function e(e){var n="function"==typeof Symbol&&Symbol.iterator,r=n&&e[n],o=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}function n(e,n){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,t,i=r.call(e),a=[];try{for(;(void 0===n||n-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return a}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;var r=function(e,n,r){if(r||2===arguments.length)for(var o,t=0,i=n.length;t<i;t++)!o&&t in n||(o||(o=Array.prototype.slice.call(n,0,t)),o[t]=n[t]);return e.concat(o||Array.prototype.slice.call(n))},o=function(e,n,r){this.name=e,this.version=n,this.os=r,this.type="browser"},t=function(e){this.version=e,this.type="node",this.name="node",this.os=process.platform},i=function(e,n,r,o){this.name=e,this.version=n,this.os=r,this.bot=o,this.type="bot-device"},a=function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null},s=function(){this.type="react-native",this.name="react-native",this.version=null,this.os=null},l=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,c=3,u=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],d=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function p(e){var n=function(e){return""!==e&&u.reduce((function(n,r){var o=r[0],t=r[1];if(n)return n;var i=t.exec(e);return!!i&&[o,i]}),!1)}(e);if(!n)return null;var t=n[0],s=n[1];if("searchbot"===t)return new a;var p=s[1]&&s[1].split(".").join("_").split("_").slice(0,3);p?p.length<c&&(p=r(r([],p,!0),function(e){for(var n=[],r=0;r<e;r++)n.push("0");return n}(c-p.length),!0)):p=[];var h=p.join("."),f=function(e){for(var n=0,r=d.length;n<r;n++){var o=d[n],t=o[0];if(o[1].exec(e))return t}return null}(e),w=l.exec(e);return w&&w[1]?new i(t,h,f,w[1]):new o(t,h,f)}var h,f="batch_delimiter",w="Content-Type",v="Content-Id",m="application/http",g="multipart/mixed",y="boundary",b="application/json; charset=utf-8",S="--",W="HTTP/1.1",E=(h=0,function(){return h++,"00000000-0000-0000-0000-".concat(String(h).padStart(12,"0"))});function x(n){var r,o,t,i=[];try{for(var a=e(n),s=a.next();!s.done;s=a.next()){var l=s.value,c=new URL(l.url,location.origin);i.push("".concat(S).concat(f,"\n").concat(w,": ").concat(m,"\n").concat(v,": ").concat(l.id,"\n\n").concat(l.method.toUpperCase()," ").concat(c.pathname).concat(c.search," ").concat(W,"\nHost: ").concat(c.host,"\nAccept: ").concat(b,"\n\n"))}}catch(e){r={error:e}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}i.push("".concat(S).concat(f).concat(S));var u=((t={})[w]="".concat(g,"; ").concat(y,"=").concat(f),t);return{method:"POST",body:i.join("\n"),headers:u}}var B,O,T,k,A,L,M=[{unauthorized:!1,requests:[{method:"GET",url:"api/auth"},{method:"GET",url:"api/settings/global"},{method:"GET",url:"api/settings/feature/list/enabled"},{method:"GET",url:"api/settings/user"},{method:"GET",url:"api/auth/subordinates"}]},{unauthorized:!0,requests:[{method:"GET",url:"api/config"},{method:"GET",url:"api/settings/global/theme"}]},{unauthorized:!1,requests:[{method:"GET",url:"api/exchangesrv/solutions"},{method:"GET",url:"api/exchangesrv/locked-namespaces"},{method:"GET",url:"api/worker/processes"},{method:"GET",url:"api/portal/list"}]}],P=document.querySelector("#gear-elma365 img");function C(){var e,n;window.elmaBootstrapData={batches:(e=M,n=new URL("api/batch",location.origin).href,e.flatMap((function(e){var r=e.requests.map((function(e){var n=e.url,r=e.method;return{id:E(),url:n,method:r}}));return e.unauthorized?r.map((function(e){return{requests:[e],response:fetch(new URL(e.url,location.origin).href,{method:e.method}),isBatched:!1}})):[{requests:r,response:fetch(n,x(r)),isBatched:!0}]})))},window.elmaResumeLoadApp&&setTimeout(window.elmaResumeLoadApp,0)}if(null==P||P.addEventListener("load",(function(){P&&(P.style.visibility="visible")})),null==P||P.addEventListener("error",(function(){var e;null==P||P.remove(),null===(e=document.querySelector("svg.default"))||void 0===e||e.classList.remove("hide")})),window.elmaLogInit=[],window.elmaLogInit.push({name:"app:start",time:performance.now()}),window.elmaBrowserSuccess=!1,navigator.userAgent.includes("elmaDesktopWrapper")?window.elmaWrapper="desktop":navigator.userAgent.includes("elmaMobileWrapper")&&(window.elmaWrapper="mobile"),window.elmaWrapper&&(window.elmaBrowserSuccess=!0),window.elmaBrowserSuccess)C();else{var G=["en-US","ru-RU","de-DE","es-ES"],I={ru:"ru-RU",en:"en-US",de:"de-DE",es:"es-ES"},N=[];navigator.languages&&N.push.apply(N,function(e,n,r){if(r||2===arguments.length)for(var o,t=0,i=n.length;t<i;t++)!o&&t in n||(o||(o=Array.prototype.slice.call(n,0,t)),o[t]=n[t]);return e.concat(o||Array.prototype.slice.call(n))}([],n(navigator.languages),!1)),(navigator.language||navigator.userLanguage)&&N.push(navigator.language||navigator.userLanguage),navigator.systemLanguage&&N.push(navigator.systemLanguage);var q="en-US";try{for(var $=e(N),_=$.next();!_.done;_=$.next()){var R=_.value;if(G.includes(R)){q=R;break}var j=R.slice(0,2);if(Object.prototype.hasOwnProperty.call(I,j)){q=I[j];break}}}catch(e){B={error:e}}finally{try{_&&!_.done&&(O=$.return)&&O.call($)}finally{if(B)throw B.error}}var U=document.querySelector("#notSupportedBrowser");null==U||U.classList.add("locale-"+q.toLowerCase()),T=void 0,k=void 0,L=function(){var e,r,o,i;return function(e,n){var r,o,t,i,a={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,o&&(t=2&s[0]?o.return:s[0]?o.throw||((t=o.return)&&t.call(o),0):o.next)&&!(t=t.call(o,s[1])).done)return t;switch(o=0,t&&(s=[2&s[0],t.value]),s[0]){case 0:case 1:t=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((t=(t=a.trys).length>0&&t[t.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!t||s[1]>t[0]&&s[1]<t[3])){a.label=s[1];break}if(6===s[0]&&a.label<t[1]){a.label=t[1],t=s;break}if(t&&a.label<t[2]){a.label=t[2],a.ops.push(s);break}t[2]&&a.ops.pop(),a.trys.pop();continue}s=n.call(e,a)}catch(e){s=[6,e],o=0}finally{r=t=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}(this,(function(a){switch(a.label){case 0:return[4,new Promise((function(e){if(window.indexedDB){var n=window.indexedDB.open("elmaTest",1);n.addEventListener("error",(function(){var n;null===(n=null==U?void 0:U.querySelector("button"))||void 0===n||n.setAttribute("disabled","disabled");var r=null==U?void 0:U.querySelector("p");r&&(r.style.display=""),e(!1)})),n.addEventListener("success",(function(){e(!0),n.result.close()}))}else e(!1)}))];case 1:e=a.sent();try{r=l?p(l):"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product?new s:"undefined"!=typeof navigator?p(navigator.userAgent):"undefined"!=typeof process&&process.version?new t(process.version.slice(1)):null,window.elmaBrowserSuccess=function(e){var r,o,t,i=null!==(o=null===(r=null==e?void 0:e.version)||void 0===r?void 0:r.toString())&&void 0!==o?o:"",a=n(null!==(t=null==i?void 0:i.split("."))&&void 0!==t?t:[],1)[0],s=a?Number.parseInt(a,10):0;switch(null==e?void 0:e.name){case"chrome":case"chromium-webview":case"crios":case"edge":case"edge-chromium":case"edge-ios":return s>=75;case"yandexbrowser":return s>=20;case"firefox":case"fxios":return s>=70;case"opera":return s>=60;case"safari":case"ios":case"ios-webview":return s>=11;case"android":return!0;default:return!1}}(r)&&e}catch(e){console.debug(e)}return!window.elmaBrowserSuccess&&e&&localStorage.getItem("browser-success")&&(window.elmaBrowserSuccess=!0),window.elmaBrowserSuccess?(C(),[2]):((o=document.querySelector("#gear-elma365"))&&(o.style.display="none"),U&&(U.style.display=""),null===(i=null==U?void 0:U.querySelector("button"))||void 0===i||i.addEventListener("click",(function(){window.elmaBrowserSuccess=!0,localStorage.setItem("browser-success","true"),U&&(U.style.display="none"),C()})),[2])}var l}))},new((A=void 0)||(A=Promise))((function(e,n){function r(e){try{t(L.next(e))}catch(e){n(e)}}function o(e){try{t(L.throw(e))}catch(e){n(e)}}function t(n){var t;n.done?e(n.value):(t=n.value,t instanceof A?t:new A((function(e){e(t)}))).then(r,o)}t((L=L.apply(T,k||[])).next())}))}}();